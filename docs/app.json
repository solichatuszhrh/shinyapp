[{"name":"app.R","content":"#\r\n# This is a Shiny web application. You can run the application by clicking\r\n# the 'Run App' button above.\r\n#\r\n# Find out more about building applications with Shiny here:\r\n#\r\n#    http://shiny.rstudio.com/\r\n#\r\n\r\nlibrary(shiny)\r\nlibrary(eurostat)\r\nlibrary(ggplot2)\r\nlibrary(tidyverse)\r\nlibrary(sf)\r\n\r\n# Downloading and manipulating the tabular data\r\ndata <- get_eurostat(\"migr_imm8\", time_format = \"num\") %>%\r\n  # Subset to NUTS-3 level\r\n  dplyr::filter(age == \"TOTAL\", sex== \"T\", agedef == \"COMPLET\") \r\nnames(data)[names(data) == \"geo\"] <- \"id\"\r\n\r\n# Downloading geospatial data\r\ngeodata <- read_sf(\"https://raw.githubusercontent.com/eurostat/Nuts2json/master/pub/v2/2021/3035/20M/0.json\")\r\n\r\n# Merge with attribute data with geodata\r\nmaps <- inner_join(geodata, data, by=\"id\")\r\n\r\n# Define UI for application that draws a histogram\r\nui <- fluidPage(\r\n\r\n    # Application title\r\n    titlePanel(\"Immigration by Age and Sex\"),\r\n\r\n    # Select input for the chosen country and year\r\n    sidebarLayout(\r\n        sidebarPanel(\r\n            numericInput(\"TIME_PERIOD\",\r\n                      \"Year\",\r\n                      value=2010),\r\n            selectInput(\"id\",\r\n                        \"Country\",\r\n                        choices = list(\r\n                          \"Austria\" =\t\"AT\",\t\r\n                          \"Belgium\" =\t\"BE\",\t\r\n                          \"Bulgaria\" =\t\"BG\",\r\n                          \"Switzerland\" = \"CH\",\r\n                          \"Cyprus\" =\t\"CY\",\r\n                          \"Czech Republic\" =\t\"CZ\",\r\n                          \"Germany\" = \"DE\",\r\n                          \"Denmark\" =\t\"DK\",\r\n                          \"Estonia\" =\t\"EE\",\r\n                          \"Greece\" = \"EL\",\r\n                          \"Spain\" =\t\"ES\",\r\n                          \"Finland\"\t= \"FI\",\r\n                          \"France\" =\t\"FR\",\r\n                          \"Croatia\" = \"HR\",\r\n                          \"Hungary\" =\t\"HU\",\r\n                          \"Ireland\" = \"IE\",\r\n                          \"Iceland\" = \"IS\",\r\n                          \"Italy\" = \"IT\",\r\n                          \"Liechtenstein\" = \"LI\",\r\n                          \"Lithuania\"\t= \"LT\",\r\n                          \"Luxembourg\" = \"LU\",\r\n                          \"Latvia\" =\t\"LV\",\r\n                          \"North Macedonia\" = \"MK\",\r\n                          \"Malta\"\t= \"MT\",\r\n                          \"Netherlands\" =\t\"NL\",\r\n                          \"Norway\" = \"NO\",\r\n                          \"Poland\" =\t\"PL\",\r\n                          \"Portugal\" =\t\"PT\",\r\n                          \"Romania\" =\t\"RO\",\r\n                          \"Sweden\"\t= \"SE\",\r\n                          \"Slovenia\" =\t\"SI\",\r\n                          \"Slovakia\" =\t\"SK\",\r\n                          \"United Kingdom\"\t= \"UK\"))\r\n        ),\r\n\r\n        # Show a plot of the country and year\r\n        mainPanel(\r\n          plotOutput(outputId = \"map\"),\r\n          plotOutput(outputId = \"timetrend\"),\r\n        )\r\n    )\r\n)\r\n\r\n# Define server logic required \r\nserver <- function(input, output) {\r\n\r\n  output$timetrend <- renderPlot({\r\n    ggplot(maps%>%filter(id == input$id),aes(x=TIME_PERIOD,y=values))+\r\n      geom_line(aes(colour = \"blue\"))+\r\n      labs(title = \"Trend of Immigration of the EU countries\", \r\n           x = \"Year\", y = \"Frequency\")\r\n  })\r\n\r\n  output$map <- renderPlot({\r\n    ggplot(maps%>%filter(TIME_PERIOD == input$TIME_PERIOD))+\r\n      geom_sf(aes(fill=values))+\r\n      scale_fill_gradient(low = \"red\", high = \"green\", name = \"Number of Immigrants\", label = scales::comma)+\r\n      labs(title = \"The Number of Immigrants in a Year\")\r\n  })\r\n}\r\n\r\n# Run the application \r\nshinyApp(ui = ui, server = server)\r\n","type":"text"}]
